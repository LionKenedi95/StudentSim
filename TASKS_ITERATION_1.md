# **План реализации MVP "Симулятор Студента 202X" (LLM-Agent Edition)**

Этот план составлен для пошаговой работы с AI-агентом. Каждый пункт — это отдельная сессия или промпт.  
Стек: React Native (Expo), Zustand (State), Lucide Icons.

## **ЭТАП 0: Подготовка окружения**

**Цель:** Создать чистый проект с правильной структурой.

1. **Инициализация (Руками):**
    * npx create-expo-app@latest StudentSim \--template blank
    * cd StudentSim
    * npx expo install lucide-react-native zustand @react-native-async-storage/async-storage react-native-safe-area-context clsx tailwind-merge (или nativewind если планируется tailwind).
2. **Структура папок (Промпт Агенту):**
    * **Контекст:** Файл Technical\_Spec\_StudentSim\_Updated.md (раздел 4.2).
    * **Задача:** "Создай структуру папок проекта: src/components, src/screens, src/store, src/game/config, src/game/engine, src/utils. Создай пустые файлы-заглушки для GameScreen.tsx и useGameStore.ts."

## **ЭТАП 1: UI Скелет (Immersive HUD)**

**Цель:** Сделать визуальную оболочку, в которой "живет" игра. Логики пока нет, только верстка.

3. **Базовая верстка экрана (Main HUD):**
    * **Контекст:** Technical\_Spec\_StudentSim\_Updated.md (Раздел 6.1 \- Слои).
    * **Задача:** "Реализуй GameScreen.tsx используя SafeAreaView. Раздели экран на 3 слоя с помощью абсолютного позиционирования:
        1. BackgroundLayer (на весь экран, пока просто цветной View).
        2. TopBar (Сверху).
        3. BottomDock (Снизу).  
           Сделай так, чтобы UI элементы не перекрывали друг друга на устройствах с челкой."
4. **Верхняя панель (TopBar):**
    * **Контекст:** Game.jsx (пример верстки) и ТЗ.
    * **Задача:** "В компоненте TopBar:
        * По центру размести большую полоску 'Счастье' (Gradient или цветной View).
        * Слева вертикальный стек ресурсов (иконки Lucide: Heart, Zap, Utensils, DollarSign, BookOpen). Используй мок-данные.
        * Справа место для будущих иконок квестов (пока пусто)."
5. **Нижняя панель (BottomDock):**
    * **Контекст:** ТЗ (Раздел 6.1).
    * **Задача:** "Реализуй BottomDock.
        * Слева кнопка с иконкой MapPin (смена локации).
        * По центру горизонтальный ScrollView для кнопок действий. Создай компонент ActionButton (Иконка \+ Текст \+ Время).
        * Справа кнопка Меню/Инвентаря.
        * Добавь стиль 'стекла' (полупрозрачный белый фон)."

## **ЭТАП 2: Игровое ядро (State & Time)**

**Цель:** Оживить цифры и заставить время идти.

6. **Zustand Store (Модель данных):**
    * **Контекст:** Technical\_Spec\_StudentSim\_Updated.md (Раздел 4.2 \- State Interface).
    * **Задача:** "Напиши src/store/useGameStore.ts.
        * Определи интерфейс GameState точно по ТЗ.
        * Добавь actions: updateStats(partialStats), setTime(day, hour), setLocation(locId).
        * Инициализируй дефолтные значения."
7. **Механика Времени и Действий (Real-time):**
    * **Контекст:** ТЗ (Раздел 2.2) и Game.jsx (логика useInterval).
    * **Задача:** "Реализуй хук useGameLoop или логику внутри Store.
        * Создай функцию startAction(actionId, durationGameHours). Она должна записывать activeAction с endTime \= Date.now() \+ realDuration.
        * Создай useEffect с интервалом (например, 1 сек), который проверяет, если Date.now() \> endTime, то вызывает finishAction().
        * Визуализируй прогресс выполнения действия (Progress Bar) на главном экране."
8. **Интеграция Локаций:**
    * **Контекст:** GameDesign\_StudentSim.md (Раздел 3 \- Действия).
    * **Задача:** "Создай файл src/game/config/actions.json и locations.json с данными из дизайн-документа.
        * Привяжи фон BackgroundLayer к текущей локации из стора.
        * В BottomDock показывай только те действия, которые соответствуют текущей locationId."

## **ЭТАП 3: Движок Квестов (Quest Engine)**

**Цель:** Реализовать сложную логику заданий и цепочек.

9. **Структура Квестов:**
    * **Контекст:** ТЗ (Раздел 2.5) и quests.json (пример).
    * **Задача:** "Создай файл src/game/config/quests.json. Опиши квесты 'meet\_natasha' и 'ask\_cinema' (цепочка).
        * В Store добавь поле quests: Record\<string, QuestState\>.
        * Напиши функцию-хелпер checkQuestTriggers(state), которая проходится по конфигу квестов и переводит их из LOCKED в PENDING или ACTIVE в зависимости от условий (статы, завершение предыдущих)."
10. **Жизненный цикл Квеста:**
    * **Задача:** "Реализуй логику обновления квестов в Game Loop:
        * Если статус PENDING и время вышло \-\> ACTIVE.
        * Если статус ACTIVE и есть дедлайн и время вышло \-\> FAILED (+ штраф).
        * Добавь UI компонент QuestBadge в TopBar (справа), который показывает таймер (круговой прогресс) для активных квестов."
11. **Модалка Квеста:**
    * **Задача:** "Создай компонент QuestDetailModal. При клике на бейдж квеста открывай модалку с описанием, требованиями и кнопкой 'Понятно'. Если квест выполняется через действие (например, 'Сходить в кино'), укажи это в описании."

## **ЭТАП 4: Движок Событий (Event Engine)**

**Цель:** Добавить случайности и нарратив.

12. **Конфигурация Событий:**
    * **Контекст:** Setting\_And\_Events.md.
    * **Задача:** "Перенеси 3-5 событий из файла сеттинга в src/game/config/events.json. Поддержи типы 'info' и 'choice'."
13. **Логика Триггеров:**
    * **Задача:** "В функции finishAction добавь вызов triggerRandomEvent().
        * Логика: найти события для текущей локации \-\> рандом \-\> если выпало, записать в activeEvent стора."
14. **UI Событий:**
    * **Задача:** "Реализуй EventModal. Это блокирующее окно поверх всего.
        * Отобрази заголовок, текст.
        * Отрисуй кнопки вариантов (Options).
        * При нажатии примени эффекты (updateStats) и закрой окно."

## **ЭТАП 5: Сборка и Полировка**

**Цель:** Превратить прототип в играбельный продукт.

15. **Сохранение (Persistence):**
    * **Задача:** "Подключи persist middleware из Zustand. Настрой сохранение GameState в AsyncStorage, чтобы прогресс не терялся при перезагрузке."
16. **Баланс и Контент:**
    * **Контекст:** Все .md файлы.
    * **Задача:** "Заполни JSON конфиги полным списком действий, событий (все 20 штук) и параметров баланса из дизайн-документа."
17. **Game Over экраны:**
    * **Задача:** "Добавь проверку условий поражения в Game Loop. Если HP \<= 0 или Счастье \<= 0, переключай экран на GameOverScreen с кнопкой 'Начать заново' (сброс стора)."