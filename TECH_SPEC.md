# **Техническое задание на разработку MVP игры «Симулятор студента 202X»**

## **1\. Общая информация**

**Цель проекта** — создать сатирический симулятор жизни студента в сеттинге России/СНГ 2020–2025 годов. Игрок должен балансировать между учебой, работой, выживанием и ментальным здоровьем.

**Платформы (MVP):**

* Telegram WebApp (React Native Web / React),
* iOS (React Native / Expo),
* Android (React Native / Expo).

**Ключевое отличие:** Игра строится на управлении ресурсами, смене локаций и принятии решений в условиях "суровой реальности" и актуальных мемов.

# **2\. Основные игровые механики**

## **2.1. Параметры персонажа**

Игрок управляет одним персонажем. Все параметры (кроме Денег) имеют шкалу 0–100.

### **Базовые ресурсы:**

1. **Жизни (HP)**
  * *Критическое значение:* 0 (Game Over — Больница).
  * *Влияние:* Снижается при болезнях, драках, голоде.
2. **Энергия**
  * *Критическое значение:* \< 10 (Блокировка действий работы/учебы).
  * *Влияние:* Тратится на любые действия. Восстанавливается сном.
3. **Счастье (Ментальное здоровье)**
  * *Критическое значение:* 0 (Game Over — Депрессия/Отчисление по собственному).
  * *Влияние:* Падает от рутины, растет от развлечений.
4. **Сытость (Голод)**
  * *Шкала:* 0 (Сыт) — 100 (Голоден).
  * *Критическое значение:* 100 (Голодный обморок, Game Over).
  * *Влияние:* Растет каждый час игрового времени.
5. **Деньги (RUB)**
  * *MVP:* Ежедневное списание отсутствует (герой живет в бесплатном общежитии).
  * *Future:* Возможность съехать на квартиру, что активирует повторяющийся квест "Оплата аренды".
6. **Успеваемость (Знания)**
  * *Критическое значение:* \< 0% (Отчисление).
  * *Цель:* Держать \> 50% к моменту квестов типа "Экзамен".

## **2.2. Система Времени и Действий (Real-time)**

Действия в игре занимают реальное время, которое конвертируется в игровое.  
Игрок не может совершать другие действия, пока текущее не завершится.

### **Конфигурация времени:**

* GAME\_HOUR\_DURATION\_MS: Базовая длительность 1 игрового часа в реальных миллисекундах (например, 60 секунд).

### **Механика выполнения действия:**

1. **Старт:** Игрок нажимает кнопку (например, "На пары" — 6 часов).
2. **Процесс:** Таймер обратного отсчета \+ Блокировка UI.
3. **Завершение:** Начисление статов \-\> Проверка триггеров Квестов/Событий.

## **2.3. Система Локаций**

1. **Общага** (Сон, Еда, Зубрежка).
2. **Университет** (Пары, Сдача экзаменов, Столовая).
3. **Работа/Город** (Курьерство, Прогулки, Кино, Магазины).

## **2.4. Случайные События (Events)**

События — это короткие интерактивные сцены, прерывающие геймплей.

* **Тип А (Info):** Односторонняя информация (Toast/Modal).
* **Тип Б (Choice):** Диалог с вариантами выбора.

## **2.5. Система Квестов и Цепочек (Quest Engine)**

Это ядро прогрессии игры. Квесты — это не просто список задач, а состояния с таймерами и условиями.

### **Жизненный цикл Квеста:**

1. **Locked (Скрыт):** Игрок не знает о квесте.
2. **Pending (Ожидание/Подготовка):** Квест появился в списке ("Скоро: Оплата аренды"), но выполнить его пока нельзя или необязательно. Идет таймер обратного отсчета до фазы Active.
3. **Active (Активен):** Квест можно/нужно выполнить. Включился таймер дедлайна (если есть).
4. **Completed (Выполнен):** Игрок получил награду.
5. **Failed (Провален):** Истек таймер дедлайна \-\> Применен штраф.

### **Атрибуты Квеста:**

1. **Триггеры (Start Conditions):**
  * *Time:* День игры \= X.
  * *Event:* Завершение другого квеста (для цепочек).
  * *Stat:* Знания \< 20%.
2. **Тайминги:**
  * wait\_duration: Время нахождения в статусе Pending.
  * active\_duration: Время на выполнение (Дедлайн).
3. **Требования (Requirements):**
  * Ресурсы (Деньги, Энергия).
  * Предметы (Наличие "Курсовой").
4. **Награды (Rewards):**
  * Ресурсы.
  * *Next Quest:* ID следующего квеста.
  * *Flags:* Сюжетные метки.
5. **Штрафы (Penalties):**
  * При невыполнении в срок.

### **Типы Квестов:**

1. **Одноразовые:** Сюжетные (Знакомство, Свидание).
2. **Цепочки (Chains):** Последовательность (Знакомство \-\> Кино \-\> Отношения).
3. **Повторяющиеся (Recurring):** Реализуются через цепочку, которая триггерит саму себя через паузу (Аренда, Сессия).

# **3\. Прогресс и Экономика**

## **3.1. Семестры (Уровни)**

Реализуются через глобальные квесты "Сессия".

* Раз в 30 дней активируется цепочка квестов "Сдать Экзамен 1", "Сдать Экзамен 2".
* Условие выполнения: Знания \> 50% \+ Трата энергии.

## **3.2. Инвентарь**

Предметы могут быть условиями для выполнения квестов.

# **4\. Техническая архитектура и Стек**

Для обеспечения надежности, производительности и поддержки Web (Telegram) выбран следующий стек:

## **4.1. Core Framework**

* **React Native (Expo SDK 50+):** Managed workflow.
  * *Почему:* Упрощает сборку под iOS/Android, обеспечивает лучшую совместимость с Web через Metro bundler.
* **TypeScript (Strict Mode):**
  * *Почему:* Обязательно для сложной логики квестов и состояния, чтобы избежать runtime-ошибок.

## **4.2. State Management (Управление состоянием)**

* **Zustand:**
  * *Почему:* Легковесный, работает без Provider-ов (удобно использовать внутри игрового движка вне React-дерева), поддерживает middleware.
* **Immer:**
  * *Почему:* Упрощает изменение вложенных объектов (статы, флаги квестов) без мутаций.

## **4.3. Persistence (Хранение данных)**

* **react-native-mmkv:**
  * *Почему:* Самое быстрое хранилище для React Native (в 30 раз быстрее AsyncStorage). Критично для мгновенного сохранения состояния игры.
  * *Web-адаптер:* Для Telegram WebApp используется localStorage (через обертку zustand persist), так как MMKV — это native-модуль.

## **4.4. UI & Styling**

* **NativeWind (v4) / Tailwind CSS:**
  * *Почему:* Позволяет верстать UI в разы быстрее. Унифицирует стили между Web и Mobile. Упрощает работу с z-index и абсолютным позиционированием для игрового HUD.
* **React Native Reanimated:**
  * *Почему:* Необходим для плавных анимаций (прогресс-бары, модальные окна) на UI-потоке, чтобы интерфейс не фризил при расчетах игровой логики.
* **Lucide React Native:**
  * *Почему:* Легковесный и современный набор иконок.
* **React Native Safe Area Context:**
  * *Почему:* Обязательно для поддержки современных экранов с "челками" и Dynamic Island.

## **4.5. Navigation**

* **Expo Router (v3+):**
  * *Почему:* Файловая маршрутизация (как в Next.js). Лучшая поддержка Deep Links, что критически важно для интеграции в Telegram и переходов по push-уведомлениям.

## **4.6. Структура проекта (Feature-based)**

src/  
app/                 \# Expo Router screens  
components/          \# UI Components (Button, Modal, ProgressBar)  
ui/                \# Базовые атомы  
game/              \# Игровые компоненты (StatBar, QuestBadge)  
core/                \# Ядро игры  
store.ts           \# Zustand store  
engine.ts          \# Игровой цикл (Game Loop)  
storage.ts         \# MMKV / LocalStorage wrapper  
features/            \# Игровые модули  
quests/            \# Логика квестов и типы  
events/            \# Логика событий  
inventory/         \# Логика предметов  
data/                \# JSON конфиги  
actions.json  
quests.json  
events.json  
utils/               \# Хелперы (time converters, formatters)

## **4.7. Структура данных (State Interface)**

type QuestStatus \= 'locked' | 'pending' | 'active' | 'completed' | 'failed';

interface QuestState {  
id: string;  
status: QuestStatus;  
startTime: number;   
deadlineTime: number | null;   
}

interface GameState {  
stats: {  
hp: number;  
energy: number;  
happiness: number;  
hunger: number;  
money: number;  
knowledge: number;  
};  
quests: Record\<string, QuestState\>;   
flags: Record\<string, boolean\>;   
inventory: string\[\];  
}

# **5\. Конфигурируемость (JSON)**

Пример того, как описываются квесты и цепочки.

**quests.json:**

\[  
{  
"id": "meet\_natasha",  
"title": "Загадочная незнакомка",  
"type": "chain\_start",  
"timings": { "active\_duration": 0 },   
"rewards": { "next\_quest\_id": "ask\_cinema" }  
}  
\]

# **6\. Экраны приложения (UI/UX)**

Интерфейс строится по принципу **Immersive HUD**: минимум меню, максимум визуализации состояния через персонажа.

### **6.1. Главный Экран (Main HUD)**

Экран разделен на слои:

**Слой 1: Динамический Фон (Background)**

* Занимает 100% экрана.
* Отображает текущее состояние персонажа:
  * *Idle (Покой):* Персонаж стоит/сидит в текущей локации (Общага/Универ/Улица).
  * *Action (Действие):* Персонаж выполняет действие (Спит на кровати, Пишет конспект, Едет на велосипеде).
  * *Mood Modifier:* Если HP \< 30 или Счастье \< 20, поза персонажа меняется на уставшую/грустную.

**Слой 2: Верхняя Панель (Top Bar)**

* **Top Center (Акцент):** Широкая полоска **Счастья**. Визуально доминирует.
* **Top Left (Ресурсы):** Вертикальный стек компактных индикаторов (Иконка \+ Число/Полоска):
  1. HP (Сердце).
  2. Энергия (Молния).
  3. Сытость (Еда).
  4. Деньги (Крупно).
  5. Успеваемость (Книга).
* **Top Right (Квесты):** Вертикальный стек круглых иконок (Quest Badges).
  * Отображаются только *Active* квесты.
  * Индикатор таймера (ободок вокруг иконки).
  * Клик открывает модалку с деталями задания.

Слой 3: Нижняя Панель Управления (Bottom Control Dock)  
Панель находится поверх фона в нижней части экрана.

* **Left Corner:** Кнопка **"Локация/Карта"** (Сменить место: Общага \<-\> Универ \<-\> Город).
* **Center:** Слайдер или горизонтальный скролл **Основных действий** для текущей локации (3-4 самые частые кнопки, например: "Спать", "Есть", "Учить").
  * Кнопка **"Все действия"** (раскрывает шторку снизу вверх с полным списком).
* **Right Corner:** Кнопка **"Настройки"** (Шестеренка) / Инвентарь.

### **6.2. Вспомогательные Экраны (Overlays/Modals)**

Эти экраны открываются поверх Главного:

1. **Event Modal:** Диалоговое окно события (Иллюстрация \+ Текст \+ Кнопки выбора). Блокирует всё остальное.
2. **Quest Detail Modal:** Открывается по клику на бейдж квеста. Описание, требования, награда, таймер.
3. **Action Sheet:** Шторка со списком всех доступных действий (если их больше, чем влезает в быстрый доступ).

# **7\. План разработки MVP**

1. **Этап 1:** Инициализация проекта, настройка стека (Tailwind, Zustand, MMKV).
2. **Этап 2:** Верстка UI (Слои фона и HUD) и навигации.
3. **Этап 3:** Реализация Core Engine (Game Loop, JSON-парсер квестов).
4. **Этап 4:** Интеграция логики квестов и событий с интерфейсом.
5. **Этап 5:** Наполнение контентом и балансировка.